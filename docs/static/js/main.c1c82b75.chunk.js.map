{"version":3,"sources":["components/content.module.css","components/Errored.tsx","components/Content.tsx","App.tsx","constants.ts","services/content.ts","options.ts","index.tsx","components/errored.module.css"],"names":["module","exports","Errored","className","styles","root","indicator","src","a","Promise","resolve","reject","image","Image","onload","onerror","e","useImageLoader","React","useState","loading","setLoading","setImage","useEffect","loadImage","then","img","ImageElement","display","setDisplay","timeout","setTimeout","clearTimeout","height","style","width","maxWidth","maxHeight","alt","clsx","show","Channel","data","Container","href","user_id","slug","title","Block","imageSrc","large","url","console","log","undefined","link","class","source","loader","opacity","fill","AttachmentBlock","attachment","attachmentOverlay","pill","extension","TextBlock","ref","useRef","fontSize","setFontSize","incRef","inc","dir","flipCount","current","getBoundingClientRect","distance","window","innerHeight","tooMany","size","content_html","textBlock","hidden","position","dangerouslySetInnerHTML","__html","ChannelOrBlock","base_class","children","outerContainer","container","innerContainer","Content","getFreshContent","arena","channel","getContent","localStorage","setItem","JSON","stringify","cached","getItem","content","parse","now","Date","removeItem","updated","error","useArenaStream","failed","setFailed","setData","length","lastSeen","lastItem","id","toString","lastSeenIndex","findIndex","x","nextItem","getNext","catch","err","App","ContentClient","arenaService","this","contents","match","location","search","getChannelFromQueryString","token","ArenaClient","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c1c82b75.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"content_root__2RpRn\",\"outerContainer\":\"content_outerContainer__2BZqH\",\"innerContainer\":\"content_innerContainer__1BxGf\",\"container\":\"content_container__3PSbZ\",\"loader\":\"content_loader__2X1Q3\",\"image\":\"content_image__3UnKa\",\"show\":\"content_show__2_9hf\",\"fill\":\"content_fill__2ah13\",\"fadeIn\":\"content_fadeIn__IQHbI\",\"textBlock\":\"content_textBlock__3EOpF\",\"hidden\":\"content_hidden__36CWT\",\"attachmentOverlay\":\"content_attachmentOverlay__1y7JM\",\"pill\":\"content_pill__1Zwd3\"};","import React from 'react';\nimport styles from './errored.module.css';\n\nexport function Errored() {\n  return (\n    <div className={styles.root}>\n      <div className={styles.indicator}>snap</div>\n    </div>\n  );\n}\n","import React, { useEffect } from 'react';\nimport styles from './content.module.css';\nimport clsx from 'clsx';\nimport { ChannelApiType, BlockApiType } from 'arena-ts';\n\nasync function loadImage(src: string) {\n  return new Promise<HTMLImageElement>((resolve, reject) => {\n    const image = new Image();\n    image.onload = () => resolve(image);\n    image.onerror = (e) => reject(e);\n    image.src = src;\n  });\n}\n\nfunction useImageLoader(src?: string) {\n  const [loading, setLoading] = React.useState(true);\n  const [image, setImage] = React.useState<HTMLImageElement | null>(null);\n  useEffect(() => {\n    if (!src) return;\n    setLoading(true);\n    loadImage(src).then((img) => {\n      setImage(img);\n      setLoading(false);\n    });\n  }, [src]);\n  return {\n    image,\n    loading,\n  };\n}\n\nfunction ImageElement({ image }: { image: HTMLImageElement }) {\n  const [display, setDisplay] = React.useState(false);\n  React.useEffect(() => {\n    const timeout = setTimeout(() => setDisplay(true), 0);\n    return () => clearTimeout(timeout);\n  }, []);\n  if (image.height === 0) return null;\n  const ratio = image.width / image.height;\n  const style =\n    ratio > 1\n      ? { maxWidth: '100%', width: image.width }\n      : { maxHeight: '100%', height: image.height };\n\n  return (\n    <img\n      alt=\"main content\"\n      src={image.src}\n      style={style}\n      className={clsx(styles.image, display && styles.show)}\n    />\n  );\n}\n\nfunction Channel({ data }: { data: ChannelApiType }) {\n  return (\n    <Container href={`https://are.na/${data.user_id}/${data.slug}`}>\n      <h1>{data.title}</h1>;\n    </Container>\n  );\n}\n\nfunction Block({ data }: { data: BlockApiType }) {\n  const imageSrc = data?.image?.large.url;\n  console.log(data);\n  const { image, loading } = useImageLoader(imageSrc || undefined);\n  const link = data.class === 'Link' ? data.source?.url : undefined;\n  return (\n    <Container href={link}>\n      {image && <ImageElement image={image} />}\n      <div className={styles.loader} style={{ opacity: loading ? 1 : 0 }}>\n        <div className={styles.fill} />\n      </div>\n    </Container>\n  );\n}\n\nfunction AttachmentBlock({ data }: { data: BlockApiType }) {\n  const imageSrc = data?.image?.large.url;\n  console.log(data);\n  const { image, loading } = useImageLoader(imageSrc || undefined);\n  return (\n    <Container href={data.attachment?.url}>\n      {image && <ImageElement image={image} />}\n      {image && (\n        <div className={styles.loader} style={{ opacity: loading ? 1 : 0 }}>\n          <div className={styles.fill} />\n        </div>\n      )}\n      <div className={styles.attachmentOverlay}>\n        {!image && <h1>{data.title}</h1>}\n\n        <h1 className={styles.pill}>{data.attachment?.extension}</h1>\n      </div>\n    </Container>\n  );\n}\n\nfunction TextBlock({ data }: { data: BlockApiType }) {\n  const ref = React.useRef<HTMLDivElement>(null);\n  const [fontSize, setFontSize] = React.useState(2);\n  const [display, setDisplay] = React.useState(false);\n  const incRef = React.useRef({ inc: 1.0, dir: 0, flipCount: 0 });\n  React.useEffect(() => {\n    const height = ref.current?.getBoundingClientRect().height;\n    if (!height) return;\n    console.log('x', incRef.current.flipCount);\n    const distance = height - (window.innerHeight - 10);\n    const tooMany = incRef.current.flipCount > 10;\n    if (distance > 100 && !tooMany) {\n      if (incRef.current.dir > 0) {\n        incRef.current.inc *= 0.25;\n        incRef.current.flipCount++;\n      }\n      incRef.current.dir = -1;\n      setFontSize((size) => size - incRef.current.inc);\n    } else if (distance < 40 && !tooMany) {\n      if (incRef.current.dir < 0) {\n        incRef.current.inc *= 0.25;\n        incRef.current.flipCount++;\n      }\n      incRef.current.dir = 1;\n      setFontSize((size) => size + incRef.current.inc);\n    } else {\n      setDisplay(true);\n    }\n  }, [fontSize]);\n  if (!data.content_html) return null;\n\n  return (\n    <Container>\n      <div\n        className={clsx(styles.textBlock, !display && styles.hidden)}\n        ref={ref}\n        style={{ position: 'fixed', fontSize: `${fontSize}rem` }}\n        dangerouslySetInnerHTML={{ __html: data.content_html }}\n      />\n    </Container>\n  );\n}\n\nfunction ChannelOrBlock({ data }: { data: BlockApiType | ChannelApiType }) {\n  switch (data.base_class) {\n    case 'Block':\n      switch (data.class) {\n        case 'Attachment':\n          return <AttachmentBlock data={data} />;\n        case 'Text':\n          return <TextBlock data={data} />;\n        default:\n          return <Block data={data} />;\n      }\n    case 'Channel':\n      return <Channel data={data} />;\n    default:\n      return null;\n  }\n}\n\nfunction Container({\n  children,\n  href,\n}: React.PropsWithChildren<{ href?: string }>) {\n  return (\n    <div className={styles.root}>\n      <div className={styles.outerContainer}>\n        <a className={styles.container} href={href}>\n          <div className={styles.innerContainer}>{children}</div>\n        </a>\n      </div>\n    </div>\n  );\n}\n\nexport function Content({\n  data,\n}: {\n  data: BlockApiType | ChannelApiType | null;\n}) {\n  if (!data) return <Container />;\n  return <ChannelOrBlock data={data} />;\n}\n","import React from 'react';\nimport { Errored } from './components/Errored';\nimport { Content } from './components/Content';\nimport { ContentData, ContentService } from './services/content';\nimport {\n  CHANNEL_DATA_CACHE_KEY,\n  LAST_SEEN_KEY,\n  REFRESH_TIME_BUFFER_MS,\n} from './constants';\nimport { BlockApiType, ChannelApiType } from 'arena-ts';\n\nasync function getFreshContent(\n  arena: ContentService,\n  channel: string\n): Promise<ChannelApiType['contents']> {\n  const data = await arena.getContent(channel);\n  localStorage.setItem(CHANNEL_DATA_CACHE_KEY, JSON.stringify(data));\n  return data.data;\n}\n\nasync function getContent(\n  arena: ContentService,\n  channel: string\n): Promise<ChannelApiType['contents']> {\n  const cached = localStorage.getItem(CHANNEL_DATA_CACHE_KEY);\n  if (!cached) return getFreshContent(arena, channel);\n  try {\n    const content = JSON.parse(cached) as ContentData;\n    const now = Date.now();\n    if (content.channel !== channel) {\n      localStorage.removeItem(LAST_SEEN_KEY);\n    }\n    if (\n      content.channel === channel &&\n      now < content.updated + REFRESH_TIME_BUFFER_MS\n    ) {\n      return content.data;\n    }\n  } catch (e) {\n    console.error(e);\n  }\n  return getFreshContent(arena, channel);\n}\n\nfunction getNext(data: ChannelApiType['contents']): BlockApiType | ChannelApiType | null {\n  if (!data || data.length === 0) return null;\n  const lastSeen = localStorage.getItem(LAST_SEEN_KEY);\n  if (lastSeen == null) {\n    const lastItem = data[data.length - 1];\n    localStorage.setItem(LAST_SEEN_KEY, lastItem.id.toString(10));\n    return lastItem;\n  }\n  const lastSeenIndex = data.findIndex(x => x.id.toString(10) === lastSeen);\n  const nextIndex = lastSeenIndex > 0 ? lastSeenIndex - 1 : data.length - 1\n  const nextItem = data[nextIndex];\n  localStorage.setItem(LAST_SEEN_KEY, nextItem.id.toString(10));\n  return nextItem;\n}\n\nfunction useArenaStream(arena: ContentService, channel: string) {\n  const [loading, setLoading] = React.useState(true);\n  const [failed, setFailed] = React.useState(false);\n  const [data, setData] = React.useState<BlockApiType | ChannelApiType | null>(\n    null\n  );\n  React.useEffect(() => {\n    setLoading(true);\n    getContent(arena, channel)\n      .then((data) => {\n        setData(getNext(data));\n        setLoading(false);\n      })\n      .catch((err) => {\n        console.error(err);\n        setLoading(false);\n        setFailed(true);\n      });\n  }, [arena, channel]);\n  return {\n    loading,\n    failed,\n    data,\n  };\n}\n\nfunction App({ arena, channel }: { arena: ContentService; channel: string }) {\n  const { failed, data } = useArenaStream(arena, channel);\n\n  return (\n    <div className=\"App\">\n      {failed && <Errored />}\n      {!failed && <Content data={data} />}\n    </div>\n  );\n}\n\nexport default App;\n","export const CHANNEL_DATA_CACHE_KEY = 'channel-info';\nexport const OPTIONS_CHANNEL_KEY = 'channel';\nexport const OPTIONS_TOKEN_KEY = 'token';\nexport const LAST_SEEN_KEY = 'last-seen';\n\nexport const REFRESH_TIME_BUFFER_MS = 1000 * 60 * 20;\n","import { ChannelApiType } from 'arena-ts/dist/arena_api_types';\nimport { ArenaService } from 'arena-ts';\n\nexport type ContentData = {\n  channel: string;\n  data: ChannelApiType['contents'];\n  updated: number;\n};\n\n// export function isBlock(\n//   data: Exclude<ChannelApiType['contents'], null>[0]\n// ): data is BlockApiType & ConnectionApiType {\n//   return data.base_class === 'Block';\n// }\n\nexport interface ContentService {\n  getContent(channel: string): Promise<ContentData>;\n}\n\nexport class ContentClient implements ContentService {\n  constructor(private readonly arenaService: ArenaService) {}\n\n  async getContent(channel: string): Promise<ContentData> {\n    const data = await this.arenaService.channel(channel);\n    return {\n      channel,\n      data: data.contents,\n      updated: Date.now(),\n    };\n  }\n}\n","import { OPTIONS_CHANNEL_KEY, OPTIONS_TOKEN_KEY } from './constants';\n\nconst DEFAULT_CHANNEL = 'good-sign-offs';\n\nfunction getChannelFromQueryString() {\n  const match = window.location.search.match(/\\?channel=(.+)/);\n  if (match) {\n    return match[1];\n  }\n  return null;\n}\n\ntype Options = {\n  channel: string;\n  token?: string;\n};\n\nexport function getOptions(): Options {\n  const channel =\n    window.localStorage.getItem(OPTIONS_CHANNEL_KEY) ||\n    getChannelFromQueryString();\n  const token = window.localStorage.getItem(OPTIONS_TOKEN_KEY);\n  return {\n    channel: channel || DEFAULT_CHANNEL,\n    token: token || undefined,\n  };\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { ArenaClient } from 'arena-ts';\nimport { ContentClient } from './services/content';\nimport { getOptions } from './options';\n\nconst { token, channel } = getOptions();\nconst arena = new ContentClient(new ArenaClient({ token }));\n\nReactDOM.render(\n  <React.StrictMode>\n    <App arena={arena} channel={channel} />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"errored_root__2mzh4\",\"indicator\":\"errored_indicator__1p0FO\"};"],"sourceRoot":""}